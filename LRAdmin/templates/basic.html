<!DOCTYPE html>

<html lang="en">
{% load static %}
{% load cloudinary %}

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex">
  <title>
    {% block title %}

    {% endblock %}
  </title>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2QEBBBDZKY"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-2QEBBBDZKY');
    </script>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <script src="https://unpkg.com/lucide@latest"></script>
  <link rel="stylesheet" href="{% static 'css/home.css' %}" />
  <link rel="stylesheet" href="{% static 'css/searchnav.css' %}" />
  

  <style>
    .desktop-nav a.active {
      color: #60a5fa !important;
    }

    .moon-icon {
      display: none;
    }

    .sun-icon {
      display: block;
    }


    body.dark-mode .moon-icon {
      display: block;
    }

    body.dark-mode .sun-icon {
      display: none;
    }

    .theme-toggle-btn {
      background: none;
      border: none;
      cursor: pointer;
      padding: 8px;
      border-radius: 50%;
      transition: background-color 0.3s;
    }

    .theme-toggle-btn:hover {
      background-color: rgba(0, 0, 0, 0.1);
    }

    body.dark-mode .theme-toggle-btn:hover {
      background-color: rgba(255, 255, 255, 0.1);
    }
    @media (max-width: 768px) {
      .container {
    margin-left: auto;
    margin-right: auto;
    padding-left: 5px;
    padding-right: 5px;

    }
    .logo-light, .logo-dark{
      width: 100px !important;
    }
    .primary-btn{
      padding: 10px 5px !important;
      font-size: 14px !important;
    }
    .books-container{
      margin: 5px 10px !important;
    }
  }
  </style>

  {% block css %}

  {% endblock %}
</head>

<body>
  <header class="header">
    <div class="container">
      <div class="header-content">
        <a href="/" class="logo">
          <!-- common logo part -->
          {% cloudinary "qqeschqzlywacz6rqsbl" quality="auto" fetch_format="auto" class="logo-icon" style="width: 48px; border-radius: 15px;" alt="logo" %}
          {% cloudinary "tdehybbsyciqodgxs2rq" quality="auto" fetch_format="auto" class="logo-light" style="width: 140px; border-radius: 15px;" alt="LeafyReads" %}
          {% cloudinary "kp6b6xlwuu8d52cfhfba" quality="auto" fetch_format="auto" class="logo-dark" style="width: 140px; border-radius: 15px;" alt="LeafyReads" %}
        </a>
        
        {% if user.is_staff %}

        <nav class="desktop-nav">
          <a href="{% url 'dashboard' %}" class="{% if request.path == '/admin-dashboard/' %}active{% endif %}">Admin
            Home</a>
          <a href="{% url 'userUploads' %}"
            class="{% if request.path == '/admin-dashboard/user-uploads-books' %}active{% endif %}">User Uploads</a>
          <a href="{% url 'addBook' %}"
            class="{% if request.path == '/admin-dashboard/add-book' %}active{% endif %}">Add Book</a>
          {% if request.resolver_match.url_name == 'updateBook' %}
          <a href="{% url 'viewBookAdmin' book.slug %}" target="_blank" class="">View Book</a>
          {% endif %}
          <a href="/" class="{% if request.path == '/' %}active{% endif %}">Visit Site</a>
          <a href="/logout/">Logout</a>
          <form id="navSearch" class="nav-search-wrapper" method="get">
            <div id="navSearchBtn" class="nav-search-button" aria-label="Search"><i data-lucide="search"></i></div>
            <input type="text" name="search" id="navSearchInput" class="nav-search-input"
              placeholder="Search for books, authors, or genres..." />
            <button type="submit" id="sctive"
              style="display: none;border: none; background: #25b95f;border-radius: 8px;color: white;padding: 5px;cursor:pointer;"><span>Search</span></button>
          </form>
        </nav>
                  
        {% endif %}
          

        <div class="header-actions">
          <button id="theme-toggle" class="theme-toggle-btn">
            <i data-lucide="sun" class="sun-icon"></i>
            <i data-lucide="moon" class="moon-icon"></i>
          </button>
          <div class="btn primary-btn">Welcome {{user.username}} ✌️</div>
        </div>
      </div>
    </div>
    </div>
  </header>

  {% block body %}

  {% endblock %}


  <script src="{% static 'js/home.js' %}"></script>
  <script src="{% static 'js/navsearch.js' %}"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
    const themeToggleBtn = document.getElementById("theme-toggle");
    const body = document.body;

    const currentTheme = localStorage.getItem("theme");
    if (currentTheme === "dark") {
        body.classList.add("dark-mode");
    }
    if (themeToggleBtn) {
        themeToggleBtn.addEventListener("click", function () {

            body.classList.toggle("dark-mode");

            // Save preference to LocalStorage
            if (body.classList.contains("dark-mode")) {
                localStorage.setItem("theme", "dark");
            } else {
                localStorage.setItem("theme", "light");
            }
        });
    }

    lucide.createIcons();
});
  </script>
</body>

</html>